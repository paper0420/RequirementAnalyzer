<a href='D:\Code_Projects\RequirementAnalyzer\RequirementAnalyzer.App\Output\Index.html'>Home</a><h1>SYR_SEC_160</h1></br><li>7.7.1.16 SYR_SEC_160: SW Update Rollback Prevention</br></li><li>7.7.1.16.1 Description</br></li><li>7.7.1.16.1.0-1 Brief description: Avoid sw flashing to previous versions</br></li><li>7.7.1.16.1.0-2 Preconditions:</br></li><li>7.7.1.16.1.0-3 Trigger: SW update request</br></li><li>7.7.1.16.1.0-4 Input data: SW binaries</br></li><li>7.7.1.16.1.0-5 Description of behaviour: The boot loader shall increment a monotonic counter in the HSM
a monotonic counter in the HSM can be the tag ecy_hsm_CSAI_KEYID_SECRET_DATA_DYNAMIC_CFG_SECRET_DATA_MONOTONIC_0_BASE_0
The application to be flashed should include a fixed security label called CCU_Security_Version
 
The label CCU_Security_Version will be compared to the monotonic counter by HSM.
The BootLoader shall check the current monotonic value and compare it to the newly flashed CCU_Security_Version before writing the validity flag.
if  ecy_hsm_CSAI_KEYID_SECRET_DATA_DYNAMIC_CFG_SECRET_DATA_MONOTONIC_0_BASE_0 >= CCU_Security_Version then System must stay in boot
if  ecy_hsm_CSAI_KEYID_SECRET_DATA_DYNAMIC_CFG_SECRET_DATA_MONOTONIC_0_BASE_0 <  CCU_Security_Version then SW update is allowed.and ecy_hsm_CSAI_KEYID_SECRET_DATA_DYNAMIC_CFG_SECRET_DATA_MONOTONIC_0_BASE_0 must be updated
Version in HSM will be updated in HSM during first boot after initial software flash 
if read version from HSM failed, This CCU must be carefully checked. stay in boot and Report positive response with error code (0x03)
if read version from image binary failed, consider image invalid and Report positive response with error code (0x02)</br></li><li>7.7.1.16.1.0-6 Timing Requirements: none</br></li><li>7.7.1.16.1.0-7 Output data: CCU SW rollback prevented. CCU SW rollback allowed and flag in HSM updated</br></li><li>7.7.1.16.1.0-8 Postconditions: none</br></li><li>7.7.1.16.1.0-9 Descriptions of exceptions: none</br></li><li>7.7.1.16.1.0-10 Dependencies and interactions: none</br></li><li>7.7.1.16.2 Differences to CRS</br></li><li>7.7.1.16.2.0-1 xxx</br></li><li>7.7.1.16.3 Questions and Answers</br></li><li>7.7.1.16.3.0-1 xxx</br></li>